<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Binary">
    <title>Binary</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script 
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBNjg2ZqtsUmoXcMq-guhJAPwY9lIUNPkI&libraries=places"
  async defer>
</script>
</head>
<body>
    <div id="root"></div>
    
<script type="text/babel">
const { useState, useEffect } = React;

// === SVG icons ===
const ThumbsUp = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M7 10v12"/><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"/></svg>;
const ThumbsDown = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 14V2"/><path d="M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z"/></svg>;
const List = () => <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>;
const Trash2 = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>;
const Filter = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>;
const MessageSquare = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>;

// === Master category list ===
const ALL_CATEGORIES = [
  'Food', 'Coffee', 'Beverages', 'Places', 'Books', 'Movies',
  'Cheese', 'Dates', 'People', 'Sports', 'Entertainment', 'Things', 'Other'
];

// Cache for category detection
let categoryCache = {};
try {
  const storedCache = localStorage.getItem("categoryCache");
  if (storedCache) categoryCache = JSON.parse(storedCache);
} catch(err){ console.warn(err); }

function saveCache() {
  try { localStorage.setItem("categoryCache", JSON.stringify(categoryCache)); }
  catch(err){ console.warn(err); }
}
 // --- Google Places Smart Category Detection ---
    // Helper: wait for Google Maps API
function waitForGoogleMaps() {
  return new Promise(resolve => {
    if (window.google && window.google.maps) return resolve();
    const interval = setInterval(() => {
      if (window.google && window.google.maps) {
        clearInterval(interval);
        resolve();
      }
    }, 100);
  });
}
    async function detectCategorySmart(text, userLat, userLng) {
      const lowerText = text.toLowerCase();

      if (window.google && window.google.maps) {
        try {
          // Promise wrapper
          const placeCat = await new Promise((resolve) => {
            const service = new google.maps.places.AutocompleteService();

            // --- Helper to call Autocomplete ---
            function getPredictions(typesArray, callback) {
              const request = {
                input: text,
                types: typesArray
              };
              // If location is available, bias results
              if (userLat && userLng && typesArray.includes('establishment')) {
                request.location = new google.maps.LatLng(userLat, userLng);
                request.radius = 2000; // 2 km
              }
              service.getPlacePredictions(request, callback);
            }

            // --- Try establishments first ---
            getPredictions(['establishment'], (predictions, status) => {
              if (status === google.maps.places.PlacesServiceStatus.OK && predictions?.length) {
                const first = predictions[0];
                const detailsService = new google.maps.places.PlacesService(document.createElement('div'));
                detailsService.getDetails({ placeId: first.place_id, fields: ['types','geometry','name'] }, (place, detailsStatus) => {
                  if (detailsStatus === google.maps.places.PlacesServiceStatus.OK && place?.types) {
                    if (place.types.includes('cafe')) resolve('Coffee');
                    else if (place.types.includes('restaurant')) resolve('Food');
                    else if (place.types.includes('bar')) resolve('Beverages');
                    else if (place.types.includes('park') || place.types.includes('museum') || place.types.includes('tourist_attraction')) resolve('Places');
                    else resolve(null);
                  } else resolve(null);
                });
              } else {
                // --- Try cities/countries ---
                getPredictions(['(cities)'], (predictions2, status2) => {
                  if (status2 === google.maps.places.PlacesServiceStatus.OK && predictions2?.length) {
                    const first = predictions2[0];
                    resolve('Places'); // Treat cities/countries as Places
                  } else resolve(null);
                });
              }
            });
          });

          if (placeCat) return placeCat;
        } catch(err){ console.warn('Google Places detection failed', err);}
      }
// Enhanced keyword patterns
const CATEGORY_KEYWORDS = {
  Cheese: {
    exact: ["cheese","cheddar","brie","gouda","mozzarella","parmesan","feta","camembert","gruyere","manchego","pecorino","ricotta","stilton","roquefort","gorgonzola","emmental","havarti","provolone",
"cheddar", "parmigiano reggiano", "parmesan", "roquefort", "brie", "gruyere", "feta", "mozzarella", "manchego", "gorgonzola", "epoisses", "swiss", "gouda", "monterey jack", "muenster", "provolone", "blue cheese", "camembert", "irish cheddar", "havarti", "buffalo mozzarella", "colby jack", "edam", "ricotta", "pepper jack", "goat cheese", "colby", "stilton", "emmentaler", "cream cheese", "comte", "american farmhouse cheddar", "cottage cheese", "grana padano", "halloumi", "rembrandt gouda", "sharp provolone", "danish blue", "saint albray", "appenzeller", "mascarpone", "tomme de savoie", "string cheese", "saint marcellin", "american cheese", "pont l'eveque", "mahon", "cantal", "emmental francais", "selles sur cher", "neufchatel", "morbier", "fourme de montbrison", "caprice des dieux", "reblochon", "coulommiers", "taleggio", "vacherin", "beaufort", "beaufort alpage", "abondance", "saint paulin", "chaource", "livarot", "rocamadour", "cambozola", "oregon blue vein", "leonora goat cheese", "pimento cheese", "banon", "cabrales", "tete de moine", "boerenkaas", "emmental de savoie", "brocciu", "laguiole", "limburger", "queso de bola", "maroilles", "stichelton", "ossau iraty", "saint nectaire", "crottin de chavignol", "mimolette", "pelardon", "fourme dambert", "fromage frais", "bleu du vercors sassenage", "cabecou", "saint felicien", "bleu d'auvergne", "bleu de bresse", "farmer cheese", "hooligan", "bleu des causses", "cotija", "burrata", "oaxaca", "fontina", "asiago", "chihuahua", "raclette", "romano", "jarlsberg", "mizithra", "panela", "provel", "asadero", "dubliner", "fontinella", "kasseri", "paneer", "bocconcini", "sharp cheddar", "mild cheddar", "extra sharp cheddar", "white cheddar", "new york style cheddar", "vermont cheddar", "aged gouda", "young gouda", "smoked gouda", "goat feta", "sheep feta", "blue stilton", "gorgonzola dolce", "gorgonzola piccante", "roquefort piquant", "danish gorgonzola", "cabrales blue", "valdeon", "tetilla", "idiiazabal", "roncal", "aragon", "zamora", "la peral", "beyaz peynir", "kasar peyniri", "otlu peynir", "tulum peyniri", "montasio", "scamorza", "caciocavallo", "provola", "stracchino", "quadrello di bufala", "bitto", "dolcelatte", "castello blue", "cabrales", "mahon", "idiiazabal", "roncal", "tetilla", "aragon", "zamora", "la peral", "beyaz peynir", "kasar peyniri", "otlu peynir", "tulum peyniri", "armenia string", "smoked string cheese", "marinated string cheese", "kraft singles", "american processed", "wisconsin cheddar", "california jack", "colby longhorn", "longhorn cheese", "brick cheese", "limpa", "saga blue", "fynbo", "esrom", "danbo", "tybo", "samsø", "vasterbottensost", "prastost", "hushallsost", "greve", "adelost", "bla gotland", "moose cheese", "liptauer", "orda", "palpusztai", "trappista", "oasis", "balaton", "karavan", "pannonia", "hofdingi", "fried camembert", "sar", "jani", "latvian cheese", "cancoillotte", "creme de chapelain", "fromage gouda de biere du battin", "gbejna", "cascaval", "urdă", "brânză", "brânză de vaci", "brânză de burduf", "brânză de suhaia", "caș", "nasal cheese", "telemea", "circassian cheese", "korall", "russian cheese", "tvorog", "kackavalj", "pule cheese", "bryndza", "ovca hrudka", "kravska hrudka", "korbaciky", "ostiepok", "parenica", "urda", "tvaroh", "encian", "plesnivec", "mohant", "tolminc cheese", "bohinc joze", "nanoski", "planinski", "adelost", "bla gotland", "greve", "graddost", "herrgardsost", "hushallsost", "moose cheese", "prastost", "svecia", "vasterbottensost", "bilozhar", "bukovynskyi", "dobrodar", "smetankovyi", "syr", "ukrainskyi", "vurda", "banbury cheese", "stilton cheese", "wensleydale cheese", "stinking bishop cheese", "red leicester", "lighvan cheese", "talesh cheese", "mahali cheese", "pot cheese", "tzfatit kashah", "tzfatit triah", "labneh", "kashkawal", "qishta", "hemed", "kedem", "knaaan", "hermon", "khalla", "arrabah", "kafrit", "areesh", "baladi cheese", "basket cheese", "charkassiye", "jameed", "jibneh arabieh", "jibne baida", "kashkawan", "majdoule", "nabulsi cheese", "shelal", "surke", "syrian cheese", "baladi", "charkassiye", "abaza", "antep peyniri", "armola peyniri", "arnavut", "beyaz peynir", "camur", "cecile", "coklek", "comlek peyniri", "dil peyniri", "edirne", "ezine peyniri", "fume cerkes peyniri", "hellim", "kars gravyeri", "kasar", "keci peyniri", "kirli hanim", "kopanisti peyniri", "kuflu peynir", "lor", "malakan peyniri", "mihalic peyniri", "obruk", "orgu", "salamura", "sayas", "suzme yogurt", "telli peynir", "tulum", "van otlu peyniri", "yemeni cheese", "allegretto cheese", "bleu benedictin", "cheddar cheese", "cheese curds", "oka", "pikauba", "palmito cheese", "turrialba cheese", "cuajada", "crema", "enredo", "queto", "quesillo", "queijo seco", "adobera cheese", "anejo cheese", "asadero cheese", "chiapas cheese", "chihuahua cheese", "cotija cheese", "criollo cheese", "lingallin", "oaxaca cheese", "queso crema", "queso de cuajo", "queso fresco", "queso panela", "requeson", "bergenost", "brick cheese", "colby cheese", "colby jack cheese", "colorado blackie", "cream cheese", "creole cream cheese", "cup cheese", "farmer cheese", "hoop cheese", "humboldt fog", "liederkranz cheese", "monterey jack", "muenster cheese", "nacho cheese", "pepper jack cheese", "pinconning cheese", "provel cheese", "red hawk", "string cheese", "teleme cheese", "cottage cheese", "tasty cheese", "cremoso cheese", "criollo", "goya", "reggianito", "sardo", "chubut", "tandil", "mar del plata", "tafi del valle", "cuartirolo", "provoleta", "queso de maquina", "chaqueno", "menonita", "catupiry", "minas", "queijo coalho", "queijo de colonia", "queijo meia cura", "queijo canastra", "queijo coboco", "queijo do reino", "queijo do serro", "queijo manteiga", "queijo prato", "requeijao", "chanco cheese", "panquehue", "renaico", "queso campesino", "queso costeno", "queso paipa", "queso pera", "queso 7 cueros", "paraguay", "allpachaca", "queso andino", "colonia", "danbo", "sandwich", "termal", "yamandu", "zapican", "guayanes cheese", "queso crineja", "queso de mano", "queso llanero", "queso palmita", "queso parma de barinitas", "queso telita", "farmer cheese", "port wine cheese", "smoked cheese", "soy cheese", "rice cheese","parmigiano reggiano", "roquefort", "brie", "gruyere", "feta", "mozzarella", "manchego", "gouda", "camembert", "stilton", "blue cheese", "ricotta", "provolone", "havarti", "swiss", "american", "colby", "monterey jack", "pepper jack", "cottage cheese", "cream cheese", "goat cheese", "halloumi", "paneer", "queso fresco", "string cheese", "mascarpone", "burrata", "fontina", "asiago", "gorgonzola", "pecorino", "edam", "limburger", "muenster", "romano", "taleggio", "wensleydale", "cheshire", "double gloucester", "caerphilly", "lanark blue", "dunsyre blue", "crowdie", "caboc", "bonchester", "dorset blue vinney", "shropshire blue", "stinking bishop", "bartlett", "cooper hill", "appleby's cheshire", "red dragon", "caerphilly", "yarg", "cornish brie", "devon blue", "ribblesdale", "mendip", "westcombe", "montasio", "scamorza", "caciocavallo", "provola", "stracchino", "quadrello di bufala", "taleggio", "bitto", "asiago", "montasio", "gorgonzola", "dolcelatte", "p Castello", "castello blue", "danish blue", "roque fort", "cabrales", "valdeon", "tetilla", "mahon", "cabrales", "idiiazabal", "roncal", "tetilla", "aragon", "zamora", "la peral", "beyaz peynir", "kaşar peyniri", "otlu peynir", "tulum peyniri"],
  },
  Coffee: {
    exact: ["coffee","cafe","latte","espresso","cappuccino","americano","macchiato","mocha","flat white","cortado","affogato", "espresso", "latte", "cappuccino", "americano", "macchiato", "mocha", "flat white", "cortado", "affogato", "ristretto", "long black", "dopio", "single shot", "double shot", "triple shot", "iced latte", "iced coffee", "cold brew", "nitro cold brew", "pour over", "drip coffee", "french press", "aeropress", "moka pot", "turkish coffee", "greek coffee", "vietnamese coffee", "iced vietnamese", "bulletproof coffee", "dirty chai", "chai latte", "matcha latte", "golden milk", "hot chocolate", "peppermint mocha", "caramel macchiato", "vanilla latte", "pumpkin spice latte", "salted caramel mocha", "hazelnut latte", "almond milk latte", "oat milk latte", "soy latte", "coconut milk latte", "decaf latte", "half caff", "skinny latte", "grande latte", "venti latte", "tall latte", "short latte", "piccolo latte", "magic", "batch brew", "chemex", "v60", "kalita", "syphon", "siphon", "vacuum pot", "percolator", "cowboy coffee", "instant coffee", "nespresso", "keurig pod", "starbucks frappuccino", "blended iced coffee", "java chip frapp", "cookies and cream frapp", "green tea frapp", "strawberry frapp", "mango frapp", "iced matcha", "iced chai", "london fog", "earl grey latte", "rose latte", "lavender latte", "honey latte", "gingerbread latte", "eggnog latte", "peppermint latte", "cinnamon dolce latte", "toasted white mocha", "chestnut praline latte", "caramel brulee latte", "birthday cake frapp", "unicorn frapp", "zombie frapp", "medicine ball", "pink drink", "dragon drink", "paradise drink", "sunset drink", "mango dragonfruit", "strawberry acai", "passion tango", "pineapple passionfruit", "orange mango", "kiwi starfruit", "cucumber lime", "café cubano", "espresso freddo", "ipoh white coffee", "starbucks", "dunkin", "peets coffee", "blue bottle", "intelligentsia", "stumptown", "costa coffee", "cafe nero", "pret a manger", "tim hortons", "lavazza cafe", "illy cafe", "croissant", "scone", "muffin", "danish", "pain au chocolat", "cinnamon roll", "brownie", "cookie", "cheesecake slice", "tiramisu", "affogato dessert", "cozy cafe", "wifi cafe", "outdoor seating cafe", "cafe patio", "drive thru cafe", "cafe ambiance", "barista service", "cafe playlist", "morning coffee spot", "afternoon tea cafe"],
    partial: ["starbucks","costa","cafe nero","pret"],
  },
  Beverages: {
    exact: ["bar","pub","cocktail","brewery", "chocolate martini", "dive bar", "rooftop bar", "sports bar", "wine bar", "craft cocktail bar", "happy hour", "pub trivia", "karaoke bar", "live music pub", "bar patio", "speakeasy", "tiki bar", "irish pub", "microbrewery", "beer","wine","gin","vodka","whiskey","rum","tequila","ale","lager","cider","spirits","champagne","prosecco", "beer", "wine", "cocktail", "gin", "vodka", "whiskey", "rum", "tequila", "ale", "lager", "cider", "spirits", "champagne", "prosecco", "martini", "margarita", "mojito", "old fashioned", "negroni", "daiquiri", "manhattan", "cosmopolitan", "bloody mary", "pina colada", "mai tai", "zombie", "espresso martini", "irish coffee", "white russian", "black russian", "screwdriver", "vodka tonic", "gin and tonic", "whiskey sour", "rum and coke", "tequila sunrise", "blue lagoon", "sex on the beach", "long island iced tea", "appletini", "lemon drop", "godfather", "rusty nail", "french 75", "sidecar", "sazerac", "aviation", "last word", "paper plane", "penicillin", "naked and famous", "oaxaca old fashioned", "vesper", "vesper martini", "dirty martini", "dry martini", "wet martini", "perfect martini", "vodka martini", "gibson", "rob roy", "boulevardier", "blood and sand", "angel's share", "jack rose", "monkey gland", "between the sheets", "el presidente", "daiquiri no 3", "mary pickford", "zombie 1934", "painkiller", "dark n stormy", "moscow mule", "paloma", "ranch water", "texas ranger", "bloody maria", "michelada", "caipirinha", "caipiroska", "batida", "batanga", "el diablo", "mule", "kentucky mule", "gin mule", "irish mule", "ginger mule", "kentucky colonel", "mint julep", "el toro", "cuba libre", "sea breeze", "bay breeze", "cape codder", "madras", "harvey wallbanger", "fuzzy navel", "tootsie roll", "kamikaze", "b-52", "tequila sunrise", "blue hawaiian", "hawaiian punch", "strawberry daiquiri", "frozen margarita", "frozen daiquiri", "frozen mudslide", "grasshopper", "mudslide", "chocolate martini", "chocolate martini", "dive bar", "rooftop bar", "sports bar", "wine bar", "craft cocktail bar", "happy hour", "pub trivia", "karaoke bar", "live music pub", "bar patio", "speakeasy", "tiki bar", "irish pub", "microbrewery"],
    partial: ["taproom","brewpub","tavern","lounge"],
  },
  Food: {
    exact: ["restaurant","ramen","pizza","burger","pasta","sushi","taco","curry","noodles","sandwich","steak","chicken","seafood","bakery","diner","bistro", "pizza", "burger", "sushi", "ramen", "taco", "pasta", "curry", "noodles", "sandwich", "steak", "chicken", "seafood", "salad", "fries", "wings", "nachos", "burrito", "falafel", "gyro", "pho", "dim sum", "bibimbap", "pad thai", "massaman curry", "neapolitan pizza", "peking duck", "rendang", "som tam", "chili crab", "cacio e pepe", "baklava", "guinea pig", "escaveche", "laksa", "escargot", "stroganoff", "katsu", "tempura", "onigiri", "udon", "soba", "biryani", "dosa", "samosa", "butter chicken", "tikka masala", "falooda", "poutine", "tourtière", "boudin", "gumbo", "jambalaya", "beignet", "lobster roll", "clam chowder", "key lime pie", "reuben", "cheeseburger", "hot dog", "corn dog", "mac and cheese", "grilled cheese", "BLT", "club sandwich", "wrap", "quesadilla", "enchilada", "empanada", "arepa", "pupusa", "tamale", "ceviche", "poke bowl", "acai bowl", "quinoa bowl", "buddha bowl", "caesar salad", "greek salad", "cob salad", "potato salad", "coleslaw", "hummus", "tzatziki", "guacamole", "salsa", "chips", "popcorn", "pretzel", "donut", "bagel", "croissant", "muffin", "pancake", "waffle", "french toast", "eggs benedict", "omelette", "quiche", "frittata", "hash browns", "bacon", "sausage", "ham", "turkey", "roast beef", "pulled pork", "brisket", "ribs", "meatloaf", "chili", "soup", "stew", "risotto", "paella", "couscous", "tabbouleh", "falafel wrap", "shawarma", "kebab", "souvlaki", "moussaka", "spanakopita", "dolma", "borek", "knish", "latke", "blini", "pierogi", "pelmeni", "vareniki", "goulash", "paprikash", "sauerkraut", "kimchi", "japchae", "bulgogi", "galbi", "hot pot", "shabu shabu", "sukiyaki", "okonomiyaki", "takoyaki", "gyoza", "baozi", "xiaolongbao", "congee"],
    partial: ["cuisine","eatery","grill","kitchen"],
  },
  Places: {
    exact: ["museum","statue of liberty", "eiffel tower", "big ben", "leaning tower of pisa", "colosseum", "taj mahal", "great wall of china", "pyramids of giza", "sydney opera house", "burj khalifa", "times square", "central park", "grand canyon", "niagara falls", "mount rushmore", "alcatraz island", "metropolitan museum of art", "national museum of world war ii", "louvre museum", "vatican city", "sistine chapel", "venice canals", "amalfi coast", "santorini", "machu picchu", "christ the redeemer", "petra", "great barrier reef", "yellowstone national park", "yosemite national park", "zion national park", "banff national park", "sahara desert", "amazon rainforest", "galapagos islands", "fjord norway", "iceland blue lagoon", "tokyo tower", "shanghai bund", "hong kong victoria peak", "dubai mall", "abu dhabi louvre", "cape town table mountain", "rio de janeiro copacabana", "buenos aires tango district", "mexico city zocalo", "cancun beaches", "havana old town", "toronto cn tower", "vancouver stanley park", "seattle space needle", "las vegas strip", "miami south beach", "new orleans french quarter", "chicago millennium park", "boston freedom trail", "washington dc mall", "philadelphia liberty bell", "san francisco golden gate", "los angeles hollywood sign", "disneyland", "universal studios", "stonehenge", "edinburgh castle", "dublin temple bar", "amsterdam canals", "brussels grand place", "berlin wall", "prague charles bridge", "budapest parliament", "vienna schonnbrunn", "moscow red square", "st petersburg hermitage", "istanbul hagia sophia", "athens acropolis", "rome trevi fountain", "barcelona sagrada familia", "madrid prado museum", "lisbon belem tower", "porto ribeira", "seville alcazar","park","beach","monument","gallery","plaza","square","garden","island","mountain","lake","resort","castle","palace","temple","cathedral"],
    partial: ["tourist","attraction","landmark","historic"],
  },
  Books: {
    exact: ["novel","memoir","biography","poetry","textbook", "book", "onyx storm", "the tenant", "one golden summer", "my friends", "the covenant of water", "shield maiden", "deep end", "first-time caller", "scythe and sparrow", "rebel witch", "famous last words", "sunrise on the reaping", "wild dark shore", "atmosphere", "broken country", "the crash", "beautiful ugly", "the favorites", "witchcraft for wayward girls", "the midnight library", "atomic habits", "educated", "i'm glad my mom died", "the seven husbands of evelyn hugo", "book lovers", "the love hypothesis", "it ends with us", "verity", "the silent patient", "where the crawdads sing", "the song of achilles", "circe", "a court of thorns and roses", "the housemaid", "the guest list", "the hunt for red october", "1984", "to kill a mockingbird", "pride and prejudice", "the great gatsby", "harry potter and the sorcerer's stone", "the da vinci code", "the alchemist", "sapiens", "becoming", "the power of habit", "quiet", "daring greatly", "the body keeps the score", "how to win friends and influence people", "thinking fast and slow", "man’s search for meaning", "the subtle art of not giving a f*ck", "milk and honey", "the sun and her flowers", "goodreads choice awards 2025 winner"],
    partial: ["author","reading","literature"],
  },
  Movies: {
    exact: ["film","cinema","documentary","series","episode", "the godfather", "casablanca", "l.a. confidential", "seven samurai", "parasite", "schindler's list", "the shawshank redemption", "the dark knight", "12 angry men", "the godfather part ii", "pulp fiction", "forrest gump", "the good the bad and the ugly", "the lord of the rings the return of the king", "fight club", "inception", "goodfellas", "star wars a new hope", "the matrix", "se7en", "city of god", "it's a wonderful life", "the silence of the lambs", "saving private ryan", "life is beautiful", "spirited away", "interstellar", "the green mile", "singin' in the rain", "the pianist", "the lion king", "back to the future", "american history x", "gladiator", "the usual suspects", "leon the professional", "the prestige", "memento", "whiplash", "the intouchables", "alien", "once upon a time in the west", "rear window", "psycho", "the shining", "raiders of the lost ark", "toy story", "jaws", "clockwork orange", "the empire strikes back", "amadeus", "the sting", "braveheart", "good will hunting", "la la land", "moonlight", "get out", "birdman", "mad max fury road", "spotlight", "room", "the revenant", "the big short", "12 years a slave", "argo", "gravity", "her", "the wolf of wall street", "dallas buyers club", "the king's speech", "black swan", "the social network", "inception", "the hurt locker", "slumdog millionaire", "no country for old men", "the departed", "brokeback mountain", "crash", "million dollar baby", "finding nemo", "lord of the rings the fellowship of the ring", "the matrix", "titanic", "jurassic park", "schindler's list", "forrest gump", "the silence of the lambs"],
    partial: ["actor","director","netflix","disney"],
  },
  Things: {
    exact: ["shoes", "bike", "sneakers", "jacket", "laptop", "bag", "phone", "watch", "headphones", "camera", "tablet", "keyboard", "backpack", "suitcase", "umbrella", "pendant necklace", "wool beanie", "western boots", "gym bag", "boot scrubber", "belly band", "air fryer", "wireless earbuds", "smartwatch", "blender", "coffee maker", "vacuum cleaner", "sunglasses", "t-shirt", "jeans", "dress", "handbag", "wallet", "belt", "scarf", "hat", "gloves", "socks", "underwear", "bra", "swimsuit", "yoga mat", "dumbbells", "jump rope", "resistance bands", "protein shaker", "water bottle", "thermos", "lunch box", "notebook", "pen", "highlighter", "planner", "lamp", "pillow", "blanket", "towel", "soap", "shampoo", "conditioner", "toothbrush", "toothpaste", "floss", "razor", "weather app", "ride share", "delivery service", "streaming service", "fitness app", "meditation app", "budget tracker", "recipe app", "language learning", "podcast player", "news feed", "photo editor", "music playlist", "online shopping", "banking app", "email client", "calendar sync", "note taking", "password manager", "vpn service", "cloud storage", "antivirus software", "web browser", "social media", "dating app", "job search", "travel booking", "hotel review", "flight tracker", "car rental", "insurance quote", "doctor appointment", "therapy session", "gym membership", "yoga class online", "cooking tutorial", "diy project", "home repair service", "cleaning service", "dog walking", "pet grooming", "laundry pickup", "grocery delivery", "meal kit", "subscription box", "coffee subscription", "book club", "online course", "webinar", "virtual event", "customer support", "tech help", "plumbing service", "electrician", "landscaping", "tutoring", "music lesson", "art class", "dance studio", "hair salon", "nail salon", "massage therapy", "acupuncture", "chiropractor", "dentist visit", "eye exam", "vet checkup", "car wash", "oil change", "tire rotation", "phone repair", "laptop fix", "warranty claim", "return policy", "gift card", "loyalty program", "cashback offer", "discount code", "free trial", "deodorant", "perfume", "lipstick", "mascara", "foundation", "blush", "eyeliner", "nail polish", "hair dryer", "straightener", "curling iron", "makeup bag", "skincare cream", "sunscreen", "moisturizer", "serum", "face mask", "body lotion", "hand sanitizer", "tissues", "bandages","shoes","bike","sneakers","jacket","laptop","bag","phone","watch","headphones","camera","tablet","keyboard","backpack","suitcase","umbrella"],
  },
  Activities: {
    exact: ["football", "soccer", "basketball", "tennis", "cricket", "rugby", "baseball", "hockey", "golf", "swimming", "volleyball", "table tennis", "badminton", "boxing", "wrestling", "martial arts", "karate", "judo", "gymnastics", "athletics", "track", "field", "surfing", "skiing", "snowboarding", "skateboarding", "climbing", "hiking", "running", "cycling", "yoga", "pilates", "archery", "bmx", "fencing", "golf", "handball", "lacrosse", "netball", "polo", "squash", "water polo", "curling", "darts", "equestrian", "fishing", "formula 1", "motocross", "nascar", "paddleboarding", "rowing", "sailing", "scuba diving", "snorkeling", "triathlon", "ultimate frisbee", "weightlifting", "windsurfing", "wrestling", "zumba", "aerobics", "crossfit", "kickboxing", "muay thai", "taekwondo", "brazilian jiu-jitsu", "capoeira", "kendo", "fencing", "shooting", "bowling", "cheerleading", "dance", "figure skating", "speed skating", "bobsled", "luge", "skeleton", "alpine skiing", "freestyle skiing", "snowshoeing", "ice hockey", "field hockey", "roller derby", "softball", "cricket", "rounders", "korfball", "sepak takraw", "kabaddi", "pétanque", "bocce", "croquet", "pickleball", "padel", "football","soccer","basketball","tennis","cricket","rugby","baseball","hockey","golf","swimming","match","championship","tournament","surfing","skiing","snowboarding","skateboarding","climbing","hiking","running","cycling","yoga","pilates","boxing","wrestling","martial arts","karate","judo","gymnastics","athletics","track","field"],
  },
  Dates: {
    exact: ["movie night", "dinner date", "picnic", "beach walk", "hike", "museum visit", "concert", "wine tasting", "cooking class", "stargazing", "amusement park", "spa day", "rooftop bar", "art gallery", "bike ride", "kayaking", "pottery class", "bookstore browse", "farmers market", "sunset cruise", "dance lesson", "escape room", "hot air balloon", "couples massage", "theater show", "ice skating", "candlelit dinner", "road trip", "volunteer together", "game night", "yoga class", "photo shoot", "baking together", "gardening", "puzzle night", "live music", "trivia night", "bowling", "mini golf", "karate", "judo", "gymnastics", "athletics", "track", "field", "surfing", "skiing", "snowboarding", "skateboarding", "climbing", "hiking", "running", "cycling", "yoga", "pilates", "boxing", "wrestling", "martial arts", "rooftop yoga", "sunrise hike", "valentine's dinner", "anniversary trip", "proposal spot", "engagement party", "wedding venue", "romantic getaway", "couple's retreat", "love letter exchange", "memory lane walk", "future planning date", "date","dating","romantic","anniversary","valentine","proposal","engagement","wedding","relationship","boyfriend","girlfriend","partner","spouse"],
  },
  People: {
    exact: ["friend", "family", "colleague", "boss", "coworker", "partner", "spouse", "child", "parent", "sibling", "grandparent", "neighbor", "teacher", "student", "doctor", "nurse", "barista", "waiter", "chef", "mechanic", "barber", "stylist", "trainer", "coach", "mentor", "influencer", "celebrity", "athlete", "artist", "musician", "actor", "director", "writer", "employee", "manager", "expert", "fan", "follower", "leader", "team member", "roommate", "classmate", "ex-partner", "best friend", "acquaintance", "stranger", "mentor", "protégé", "rival", "ally", "advisor", "client", "customer", "vendor", "supplier", "landlord", "tenant", "barista", "cashier", "salesperson", "receptionist", "hostess", "driver", "pilot", "attendant", "guide", "tourist", "local", "immigrant", "nomad", "settler", "elder", "youth", "teen", "adult", "senior", "introvert", "extrovert", "leader", "supporter", "critic", "cheerleader", "doubter", "believer", "giver", "taker", "giver", "receiver", "giver", "helper", "healer", "fighter", "peacemaker", "dreamer", "doer", "thinker", "feeler", "person","friend","colleague","coworker","manager","boss","teacher","professor","doctor","nurse","artist","musician","celebrity","politician","athlete","neighbor","roommate","classmate"],
  },
  Culture: {
    exact: ["concert", "festival", "show", "performance", "theater", "comedy", "stand-up", "magic", "circus", "exhibition", "gig", "club", "nightclub", "disco", "rave", "party", "event", "taylor swift tour", "beyonce concert", "elton john farewell", "dua lipa show", "paul mccartney gig", "kendrick lamar festival", "haim performance", "bad bunny rave", "lizzo stand-up", "bono exhibition", "the 1975 club", "prince tour", "madonna concert", "aretha franklin show", "johnny cash gig", "jimi hendrix festival", "grand ole opry", "gemini comedy", "lauren taylor studio", "broadway musical", "off-broadway play", "improv night", "karaoke party", "open mic", "poetry slam", "drag show", "burlesque performance", "cabaret", "opera", "ballet", "symphony", "jazz club", "blues festival", "rock concert", "pop show", "hip hop gig", "country music event", "electronic dance rave", "indie festival", "film screening", "movie marathon", "tv series binge", "podcast live", "game show taping", "talent competition", "award ceremony", "red carpet event", "super bowl halftime", "olympics opening", "coachella", "glastonbury", "burning man", "sxsw", "comic-con", "edinburgh fringe", "concert","festival","show","performance","theater","theatre","comedy","stand-up","magic","circus","exhibition","gig","club","nightclub","disco","rave","party","event"],
  }
};

// Helper: wait for Google Maps API
function waitForGoogleMaps() {
  return new Promise(resolve => {
    if (window.google && window.google.maps) return resolve();
    const interval = setInterval(() => {
      if (window.google && window.google.maps) {
        clearInterval(interval);
        resolve();
      }
    }, 100);
  });
}


// === Smart category detection: Google Maps FIRST, then keywords, then Other ===
async function detectCategory(inputText, userLat, userLng) {
  const text = inputText.trim();
  if (!text) return 'Other';

  const lower = text.toLowerCase();
  
  // Check cache first
  if (categoryCache[text]) return categoryCache[text];

  // 1️⃣ PRIORITY: Google Places API within 2km
  try {
    await waitForGoogleMaps();
    if (window.google?.maps && userLat && userLng) {
      const service = new google.maps.places.AutocompleteService();

      const predictions = await new Promise(resolve => {
        service.getPlacePredictions({ input: text }, (preds, status) => {
          resolve(status === google.maps.places.PlacesServiceStatus.OK ? preds?.slice(0, 5) : []);
        });
      });

      if (predictions?.length) {
        const detailsService = new google.maps.places.PlacesService(document.createElement('div'));
        
        const placeResults = await Promise.all(predictions.map(p => new Promise(res => {
          detailsService.getDetails({ 
            placeId: p.place_id, 
            fields: ['types', 'geometry', 'name']
          }, place => res(place));
        })));

        // Find places within 2km
        for (const place of placeResults) {
          if (!place?.types || !place.geometry?.location) continue;

          const distance = distanceKm(
            userLat, userLng, 
            place.geometry.location.lat(), 
            place.geometry.location.lng()
          );

          // Only consider places within 2km
          if (distance <= 2) {
            // Type mapping
            const typeMap = {
              cafe: 'Coffee',
              bar: 'Beverages',
              night_club: 'Beverages',
              restaurant: 'Food',
              meal_takeaway: 'Food',
              meal_delivery: 'Food',
              food: 'Food',
              bakery: 'Food',
              museum: 'Places',
              park: 'Places',
              tourist_attraction: 'Places',
              point_of_interest: 'Places',
              establishment: 'Places'
            };

            for (const type of place.types) {
              if (typeMap[type]) {
                const category = typeMap[type];
                categoryCache[text] = category;
                saveCache();
                console.log(`✅ Matched via Google Maps (<2km): "${text}" → ${category} (${distance.toFixed(2)}km)`);
                return category;
              }
            }
          }
        }
      }
    }
  } catch(err){ 
    console.warn("Google Maps detection failed:", err); 
  }

  // 2️⃣ FALLBACK: Keyword matching
  for (const [category, config] of Object.entries(CATEGORY_KEYWORDS)) {
    if (config.exact?.somae(k => lower.includes(k))) {
      categoryCache[text] = category;
      saveCache();
      console.log(`✅ Matched via keywords: "${text}" → ${category}`);
      return category;
    }
    if (config.partial?.some(k => lower.includes(k))) {
      categoryCache[text] = category;
      saveCache();
      console.log(`✅ Matched via partial keywords: "${text}" → ${category}`);
      return category;
    }
  }

  // 3️⃣ LAST RESORT: Other
  categoryCache[text] = 'Other';
  saveCache();
  console.log(`ℹ️ No match found: "${text}" → Other`);
  return 'Other';
}

// === Main App ===
function BinaryApp() {
  const [items, setItems] = React.useState([]);
  const [inputText, setInputText] = React.useState('');
  const [selectedCategory, setSelectedCategory] = React.useState('All');
  const [isLoading, setIsLoading] = React.useState(true);
  const [editingComment, setEditingComment] = React.useState(null);
  const [commentText, setCommentText] = React.useState('');
  const [isProcessing, setIsProcessing] = React.useState(false);

  React.useEffect(() => {
    const stored = localStorage.getItem('binaryItems');
    if (stored) setItems(JSON.parse(stored));
    setIsLoading(false);

    navigator.geolocation.getCurrentPosition(
      pos => { window.userLat = pos.coords.latitude; window.userLng = pos.coords.longitude; },
      err => console.warn('Location denied:', err)
    );
  }, []);

  const saveItems = (newItems) => {
    setItems(newItems);
    localStorage.setItem('binaryItems', JSON.stringify(newItems));
  };

  const addItem = async (rating) => {
    if (!inputText.trim() || isProcessing) return;
    
    setIsProcessing(true);
    try {
      const category = await detectCategory(inputText, window.userLat, window.userLng);
      const newItem = {
        id: Date.now().toString(),
        text: inputText.trim(),
        rating,
        category,
        timestamp: Date.now(),
        date: new Date().toLocaleDateString(),
      };
      saveItems([newItem, ...items]);
      setInputText('');
    } catch (err) {
      console.error('Failed to add item:', err);
    } finally {
      setIsProcessing(false);
    }
  };

  const updateCategory = (id, newCat) => {
    saveItems(items.map(item => item.id === id ? { ...item, category: newCat } : item));
  };

  const deleteItem = (id) => saveItems(items.filter(item => item.id !== id));
  const startEditingComment = (item) => { setEditingComment(item.id); setCommentText(item.comment || ''); };
  const saveComment = (id) => { 
    saveItems(items.map(i => i.id === id ? { ...i, comment: commentText.trim() } : i));
    setEditingComment(null); setCommentText('');
  };
  const cancelEditingComment = () => { setEditingComment(null); setCommentText(''); };

  const categories = ['All', ...ALL_CATEGORIES];
  const filteredItems = selectedCategory === 'All' ? items : items.filter(i => i.category === selectedCategory);
  const getRatingEmoji = (rating) => rating === 'like' ? '👍' : '👎';
  const getRatingColor = (rating) => rating === 'like' ? 'bg-green-100 text-green-800 border-green-300' : 'bg-red-100 text-red-800 border-red-300';

  if (isLoading) return <div className="min-h-screen flex items-center justify-center text-gray-600">Loading...</div>;

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 pb-6">
      <div className="max-w-2xl mx-auto px-4 py-6">

        {/* Header */}
        <div className="text-center mb-6">
          <h1 className="text-3xl font-bold text-gray-800 mb-2">Binary</h1>
          <p className="text-gray-600">Yes/no, that's all</p>
        </div>

        {/* Input */}
        <div className="bg-white rounded-2xl shadow-lg p-6 mb-6">
          <div className="flex items-center gap-2 mb-4">
            <div className="relative flex-1">
              <input
                type="text"
                value={inputText}
                onChange={(e) => setInputText(e.target.value)}
                placeholder="What did you experience?"
                className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-400 focus:outline-none"
                onKeyPress={(e) => e.key === 'Enter' && inputText.trim() && !isProcessing && document.getElementById('like-btn').focus()}
                disabled={isProcessing}
              />
            </div>
          </div>

          <div className="text-xs text-gray-500 mb-3 text-center">
            Tap the microphone icon on your keyboard to use voice input
          </div>

          <div className="flex gap-3">
            <button
              id="like-btn"
              onClick={() => addItem('like')}
              disabled={!inputText.trim() || isProcessing}
              className="flex-1 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white font-semibold py-3 px-6 rounded-xl flex items-center justify-center gap-2 transition-colors"
            >
              <ThumbsUp />
              {isProcessing ? 'Processing...' : 'Like'}
            </button>
            <button
              onClick={() => addItem('dislike')}
              disabled={!inputText.trim() || isProcessing}
              className="flex-1 bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white font-semibold py-3 px-6 rounded-xl flex items-center justify-center gap-2 transition-colors"
            >
              <ThumbsDown />
              {isProcessing ? 'Processing...' : 'Dislike'}
            </button>
          </div>
        </div>

        {/* Filter */}
        {items.length > 0 && (
          <div className="bg-white rounded-2xl shadow-lg p-4 mb-6">
            <div className="flex items-center gap-2 mb-3"><Filter /><span className="font-semibold text-gray-700">Filter by category:</span></div>
            <div className="flex flex-wrap gap-2">
              {categories.map(cat => (
                <button
                  key={cat}
                  onClick={() => setSelectedCategory(cat)}
                  className={`px-4 py-2 rounded-lg font-medium transition-colors ${selectedCategory === cat ? 'bg-purple-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}
                >{cat}</button>
              ))}
            </div>
          </div>
        )}

        {/* Items List */}
        <div className="space-y-3">
          {filteredItems.length === 0 ? (
            <div className="bg-white rounded-2xl shadow-lg p-12 text-center">
              <div className="flex justify-center mb-4"><List /></div>
              <p className="text-gray-500">{items.length === 0 ? "No ratings yet." : "No items in this category yet."}</p>
            </div>
          ) : (
            filteredItems.map(item => (
              <div key={item.id} className="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center gap-2 mb-1">
                      <span className={`px-3 py-1 rounded-full text-sm font-semibold border-2 ${getRatingColor(item.rating)}`}>
                        {getRatingEmoji(item.rating)} {item.rating === 'like' ? 'Liked' : 'Disliked'}
                      </span>

                      <select
                        value={item.category}
                        onChange={(e) => updateCategory(item.id, e.target.value)}
                        className="px-3 py-1 rounded-full text-xs font-medium border bg-purple-100 text-purple-700"
                      >
                        {ALL_CATEGORIES.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                      </select>
                    </div>

                    <p className="text-gray-800 font-medium mb-1">{item.text}</p>
                    <p className="text-sm text-gray-500">{item.date}</p>

                    {editingComment === item.id ? (
                      <div className="mt-3 space-y-2">
                        <textarea
                          value={commentText}
                          onChange={(e) => setCommentText(e.target.value)}
                          placeholder="Add your thoughts..."
                          className="w-full px-3 py-2 border-2 border-purple-300 rounded-lg focus:border-purple-400 focus:outline-none resize-none"
                          rows="3"
                          autoFocus
                        />
                        <div className="flex gap-2">
                          <button onClick={() => saveComment(item.id)} className="px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg text-sm font-medium transition-colors">Save</button>
                          <button onClick={cancelEditingComment} className="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg text-sm font-medium transition-colors">Cancel</button>
                        </div>
                      </div>
                    ) : (
                      <>
                        {item.comment && (
                          <div className="mt-2 p-3 bg-gray-50 rounded-lg">
                            <p className="text-sm text-gray-700 italic">{item.comment}</p>
                          </div>
                        )}
                        <button onClick={() => startEditingComment(item)} className="mt-2 flex items-center gap-1 text-sm text-purple-600 hover:text-purple-700 font-medium">
                          <MessageSquare />
                          {item.comment ? 'Edit comment' : 'Add comment'}
                        </button>
                      </>
                    )}
                  </div>

                  <button onClick={() => deleteItem(item.id)} className="ml-4 p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors">
                    <Trash2 />
                  </button>
                </div>
              </div>
            ))
          )}
        </div>

        {/* Stats */}
        {items.length > 0 && (
          <div className="mt-6 bg-white rounded-2xl shadow-lg p-6">
            <h3 className="font-bold text-gray-800 mb-3">Your Stats</h3>
            <div className="grid grid-cols-2 gap-4">
              <div className="text-center p-4 bg-green-50 rounded-xl">
                <div className="text-3xl font-bold text-green-600">{items.filter(i => i.rating === 'like').length}</div>
                <div className="text-sm text-gray-600">Liked</div>
              </div>
              <div className="text-center p-4 bg-red-50 rounded-xl">
                <div className="text-3xl font-bold text-red-600">{items.filter(i => i.rating === 'dislike').length}</div>
                <div className="text-sm text-gray-600">Disliked</div>
              </div>
            </div>
          </div>
        )}

      </div>
    </div>
  );
}

        ReactDOM.render(<BinaryApp />, document.getElementById('root'));
    </script>
</body>
</html>
